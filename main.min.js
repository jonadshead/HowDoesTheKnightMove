class Piece{constructor(e,t,o){this.position=e,this.type=t,this.colour=o}}class Position{constructor(e,t){this.x=e,this.y=t}equals(e){return this.x===e.x&&this.y===e.y}}let whiteQueen,whiteBishop,whiteKnight,whiteRook,blackQueen,blackBishop,blackKnight,blackRook,inspiredLogo,blackBox,threeFive=[],fourFive=[],fiveFive=[],c=0==Math.floor(2*Math.random()),isInspiredButtonSelected=!1,isKnightSelected=!1,tempPositionData=new Position(-1,-1),pieces=[],targets=[],targetsCompleted=0,isMenuOpen=!1;function menuButtonToggle(){isMenuOpen=!isMenuOpen}function openInspiredSiteWindow(){window.open("https://www.funnyhowtheknightmoves.com/","_blank")}function preload(){threeFive=loadArrayFromFile("threeFive.json"),fourFive=loadArrayFromFile("fourFive.json"),fiveFive=loadArrayFromFile("fiveFive.json"),whiteQueen=loadImage("images/whiteQueen.png"),whiteBishop=loadImage("images/whiteBishop.png"),whiteKnight=loadImage("images/whiteKnight.png"),whiteRook=loadImage("images/whiteRook.png"),blackBishop=loadImage("images/blackBishop.png"),blackRook=loadImage("images/blackRook.png"),blackKnight=loadImage("images/blackKnight.png"),blackQueen=loadImage("images/blackQueen.png"),inspiredLogo=loadImage("images/inspired.png"),blackBox=loadImage("images/blackBox.png")}function loadArrayFromFile(e){const t=new XMLHttpRequest;if(t.open("GET",e,!1),t.send(null),200===t.status)return JSON.parse(t.responseText);throw new Error(`Error loading file: ${e}`)}function setup(){renderRandomPosition();let e=getScale();createCanvas(8.1*e,8.1*e)}function draw(){if(background("#dedede"),constructBoard(),isKnightSelected){let e=map(mouseX,0,width,0,8),t=map(mouseY,0,height,0,8);pieces[0].position=new Position(e-.5,t-.5)}for(let e=1;e<pieces.length;e++)drawPiece(pieces[e]);if(drawPiece(pieces[0]),isMenuOpen){drawMenu(),isInspiredButtonPressed();let e=getScale();mouseX>=2.5*e&&mouseX<=5.6*e&&mouseY>=3.5*e&&mouseY<=4.7*e?setCursor("pointer"):setCursor(null)}else{let e=mousePositionToPosition();isKnightSelected||e.x==pieces[0].position.x&&e.y==pieces[0].position.y?setCursor("pointer"):setCursor(null)}}function renderRandomPosition(){if(null!=threeFive&&null!=fourFive&&null!=fiveFive){let e;switch(Math.floor(3*Math.random())){case 1:e=threeFive[Math.floor(Math.random()*threeFive.length)];break;case 2:e=fourFive[Math.floor(Math.random()*fourFive.length)];break;default:e=fiveFive[Math.floor(Math.random()*fiveFive.length)]}pieces=e[1],targets=e[0]}}function setCursor(e){if("pointer"===e)document.getElementById("pointer").style.cursor="pointer";else document.getElementById("pointer").style.cursor=null}function getScale(){return.1*(windowWidth<windowHeight?windowWidth:windowHeight)}function windowResized(){let e=getScale();resizeCanvas(8.1*e,8.1*e)}function constructBoard(){let e=getScale();for(let t=0;t<8;t++)for(let o=0;o<8;o++){let[i,n]=getWorldPosition(new Position(t,o));noStroke(),targetsCompleted<targets.length&&targets[targetsCompleted].x==t&&targets[targetsCompleted].y==o?(fill("#ffb3c6"),rect(i,n,e,e)):(fill((t+o)%2==1?"#966fd6":"#FAF9F6"),rect(i,n,e,e))}}function drawMenu(){let e=getScale(),t=3.5*e,[o,i]=getWorldPosition(new Position(2.25,3.125));image(getMenuTexture("blackBox"),o,i,t,t/2);let n=3*e,[s,l]=getWorldPosition(new Position(2.52,3.5));image(getMenuTexture("inspiredLogo"),s,l,n,.37563452*n)}function isInspiredButtonPressed(){let e=getScale();isMenuOpen&&mouseButton===LEFT&&mouseX>=2.5*e&&mouseX<=5.6*e&&mouseY>=3.5*e&&mouseY<=4.7*e&&(isInspiredButtonSelected=!0)}function isInspiredButtonReleased(){let e=getScale();isInspiredButtonSelected&&isMenuOpen&&mouseButton===LEFT&&mouseX>=2.5*e&&mouseX<=5.6*e&&mouseY>=3.5*e&&mouseY<=4.7*e&&openInspiredSiteWindow(),isInspiredButtonSelected=!1}function drawPiece(e){let t=getScale(),[o,i]=getWorldPosition(e.position);image(getTexture(e.type,e.colour),o,i,t,t)}function getTexture(e,t){switch(e){case"queen":return"black"==t?blackQueen:whiteQueen;case"bishop":return"black"==t?blackBishop:whiteBishop;case"rook":return"black"==t?blackRook:whiteRook;default:return"black"==t?blackKnight:whiteKnight}}function getMenuTexture(e){return"inspiredLogo"===e?inspiredLogo:blackBox}function getWorldPosition(e){let t=getScale(),o=.05*t;return[t*e.x+o,t*e.y+o]}function mouseReleased(){if(isKnightSelected&&mouseButton===LEFT){let e=mousePositionToPosition();if(-1!=e.x&&-1!=e.y){let e=mousePositionToPosition(),t=validKnightMoves(tempPositionData),o=!1;for(let i=0;i<t.length;i++)if(t[i].x==e.x&&t[i].y==e.y){pieces[0].position=e,o=!0,targetsCompleted<targets.length&&targets[targetsCompleted].x==e.x&&targets[targetsCompleted].y==e.y&&(targetsCompleted++,targetsCompleted==targets.length&&(renderRandomPosition(),targetsCompleted=0));break}o||(pieces[0].position=tempPositionData)}else pieces[0].position=tempPositionData;isKnightSelected=!1}isInspiredButtonReleased()}function mousePressed(){let e=mousePositionToPosition();isMenuOpen||mouseButton!==LEFT||e.x!=pieces[0].position.x||e.y!=pieces[0].position.y||(tempPositionData=pieces[0].position,isKnightSelected=!0),isInspiredButtonPressed()}function mousePositionToPosition(){let e=getScale();for(let t=0;t<8;t++)for(let o=0;o<8;o++)if(mouseX>=e*(.05+t)&&mouseY>=e*(.05+o)&&mouseX<e*(1.05+t)&&mouseY<e*(1.05+o))return new Position(t,o);return new Position(-1,-1)}function validKnightMoves(e){let t=[];t.push(new Position(e.x+2,e.y+1),new Position(e.x+1,e.y+2),new Position(e.x-2,e.y-1),new Position(e.x-1,e.y-2),new Position(e.x-2,e.y+1),new Position(e.x-1,e.y+2),new Position(e.x+2,e.y-1),new Position(e.x+1,e.y-2));let o=[],i=calcBlockedTiles();for(let e=0;e<t.length;e++)if(t[e].x>=0&&t[e].x<8&&t[e].y>=0&&t[e].y<8){let n=!1;for(let o=0;o<i.length;o++)if(t[e].x==i[o].x&&t[e].y==i[o].y){n=!0;break}n||o.push(t[e])}return o}function calcBlockedTiles(){let e=[];for(let t=1;t<pieces.length;t++)switch(pieces[t].type){case"queen":e=e.concat(getBlockedQueenTiles(pieces[t].position));break;case"bishop":e=e.concat(getBlockedBishopTiles(pieces[t].position));break;case"rook":e=e.concat(getBlockedRookTiles(pieces[t].position));break;default:e=e.concat(getBlockedKnightTiles(pieces[t].position))}return e}function getBlockadesToPiecesPosition(e){let t=[];for(let o=1;o<pieces.length;o++)pieces[o].position.x==e.x&&pieces[o].position.y==e.y||t.push(pieces[o].position);return t}function getBlockedQueenTiles(e){let t=getBlockadesToPiecesPosition(e),o=[];o.push(e);for(let i=e.x+1;i<8;i++){let n=!1;for(let o=0;o<t.length;o++)if(t[o].x==i&&t[o].y==e.y){n=!0;break}if(n)break;o.push(new Position(i,e.y))}for(let i=e.x-1;i>=0;i--){let n=!1;for(let o=0;o<t.length;o++)if(t[o].x==i&&t[o].y==e.y){n=!0;break}if(n)break;o.push(new Position(i,e.y))}for(let i=e.y+1;i<8;i++){let n=!1;for(let o=0;o<t.length;o++)if(t[o].x==e.x&&t[o].y==i){n=!0;break}if(n)break;o.push(new Position(e.x,i))}for(let i=e.y-1;i>=0;i--){let n=!1;for(let o=0;o<t.length;o++)if(t[o].x==e.x&&t[o].y==i){n=!0;break}if(n)break;o.push(new Position(e.x,i))}let i=e.x+1;for(let n=e.y-1;n>=0&&i<8;n--){let e=!1;for(let o=0;o<t.length;o++)if(t[o].x==i&&t[o].y==n){e=!0;break}if(e)break;o.push(new Position(i,n)),i++}let n=e.x-1;for(let i=e.y-1;i>=0&&n>=0;i--){let e=!1;for(let o=0;o<t.length;o++)if(t[o].x==n&&t[o].y==i){e=!0;break}if(e)break;o.push(new Position(n,i)),n--}let s=e.x-1;for(let i=e.y+1;i<8&&s>=0;i++){let e=!1;for(let o=0;o<t.length;o++)if(t[o].x==s&&t[o].y==i){e=!0;break}if(e)break;o.push(new Position(s,i)),s--}let l=e.x+1;for(let i=e.y+1;i<8&&l<8;i++){let e=!1;for(let o=0;o<t.length;o++)if(t[o].x==l&&t[o].y==i){e=!0;break}if(e)break;o.push(new Position(l,i)),l++}return o}function getBlockedBishopTiles(e){let t=getBlockadesToPiecesPosition(e),o=[];o.push(e);let i=e.x+1;for(let n=e.y-1;n>=0&&i<8;n--){let e=!1;for(let o=0;o<t.length;o++)if(t[o].x==i&&t[o].y==n){e=!0;break}if(e)break;o.push(new Position(i,n)),i++}let n=e.x-1;for(let i=e.y-1;i>=0&&n>=0;i--){let e=!1;for(let o=0;o<t.length;o++)if(t[o].x==n&&t[o].y==i){e=!0;break}if(e)break;o.push(new Position(n,i)),n--}let s=e.x-1;for(let i=e.y+1;i<8&&s>=0;i++){let e=!1;for(let o=0;o<t.length;o++)if(t[o].x==s&&t[o].y==i){e=!0;break}if(e)break;o.push(new Position(s,i)),s--}let l=e.x+1;for(let i=e.y+1;i<8&&l<8;i++){let e=!1;for(let o=0;o<t.length;o++)if(t[o].x==l&&t[o].y==i){e=!0;break}if(e)break;o.push(new Position(l,i)),l++}return o}function getBlockedRookTiles(e){let t=getBlockadesToPiecesPosition(e),o=[];o.push(e);for(let i=e.x+1;i<8;i++){let n=!1;for(let o=0;o<t.length;o++)if(t[o].x==i&&t[o].y==e.y){n=!0;break}if(n)break;o.push(new Position(i,e.y))}for(let i=e.x-1;i>=0;i--){let n=!1;for(let o=0;o<t.length;o++)if(t[o].x==i&&t[o].y==e.y){n=!0;break}if(n)break;o.push(new Position(i,e.y))}for(let i=e.y+1;i<8;i++){let n=!1;for(let o=0;o<t.length;o++)if(t[o].x==e.x&&t[o].y==i){n=!0;break}if(n)break;o.push(new Position(e.x,i))}for(let i=e.y-1;i>=0;i--){let n=!1;for(let o=0;o<t.length;o++)if(t[o].x==e.x&&t[o].y==i){n=!0;break}if(n)break;o.push(new Position(e.x,i))}return o}function getBlockedKnightTiles(e){let t=[];t.push(new Position(e.x+2,e.y+1),new Position(e.x+1,e.y+2),new Position(e.x-2,e.y-1),new Position(e.x-1,e.y-2),new Position(e.x-2,e.y+1),new Position(e.x-1,e.y+2),new Position(e.x+2,e.y-1),new Position(e.x+1,e.y-2));let o=[];o.push(e);for(let e=0;e<t.length;e++)t[e].x>=0&&t[e].x<8&&t[e].y>=0&&t[e].y<8&&o.push(t[e]);return o}